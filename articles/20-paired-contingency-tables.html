<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath • ClinicoPathDescriptives</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ClinicoPathDescriptives</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.3.89</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/01-biomarkerresponse-comprehensive.html">Biomarker Response Association Analysis - Comprehensive Guide for Precision Medicine</a></li>
    <li><a class="dropdown-item" href="../articles/01-comprehensive-data-quality.html">Data Quality Assessment - Comprehensive Guide for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/01-getting-started.html">Getting Started with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/01-introduction.html">ClinicoPath Descriptives 01: Introduction to Descriptive Statistics for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/02-data-quality.html">Data Quality Assessment and Exploration</a></li>
    <li><a class="dropdown-item" href="../articles/02-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/03-data-summary.html">Summarising Clinicopathological Data</a></li>
    <li><a class="dropdown-item" href="../articles/03-getting-started-alt.html">General 02: Getting Started with Statistical Analysis for Pathologists</a></li>
    <li><a class="dropdown-item" href="../articles/03-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/03-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/04-benford-comprehensive.html">Benford's Law Analysis - Comprehensive Guide for Data Validation and Fraud Detection</a></li>
    <li><a class="dropdown-item" href="../articles/04-benford.html">Vignette: Checking Data Authenticity with Benford's Law</a></li>
    <li><a class="dropdown-item" href="../articles/04-data-quality-exploration.html">ClinicoPath Descriptives 04: Data Quality Assessment for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/05-alluvial.html">Comprehensive Guide to Alluvial Diagrams in ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/05-dataquality-comprehensive.html">Data Quality Assessment - Enhanced Visual Analysis with visdat Integration</a></li>
    <li><a class="dropdown-item" href="../articles/05-digital-pathology.html">Digital Pathology Validation: AI-Assisted Quantification and Method Comparison</a></li>
    <li><a class="dropdown-item" href="../articles/06-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/06-molecular-workflow.html">Modern Molecular Pathology Workflow: Integrated Morphologic and Molecular Diagnostics</a></li>
    <li><a class="dropdown-item" href="../articles/07-ihcstats-comprehensive-guide.html">Comprehensive IHC Analysis Guide</a></li>
    <li><a class="dropdown-item" href="../articles/08-autoeda.html">Automated Exploratory Data Analysis with AutoEDA</a></li>
    <li><a class="dropdown-item" href="../articles/08-function-agepyramid.html">Vignette: Creating an Age Pyramid with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/09-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/09-function-alluvial.html">Function Reference: alluvial() - Complete Parameter Guide</a></li>
    <li><a class="dropdown-item" href="../articles/10-function-benford.html">Vignette: Performing a Benford's Law Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/10-visualization-gallery.html">Visualization Gallery for Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/11-function-crosstable.html">Vignette: Generating a Publication-Ready 'Table 1' with crosstable</a></li>
    <li><a class="dropdown-item" href="../articles/12-function-reportcat.html">Vignette: Generating Quick Summaries of Categorical Pathology Data</a></li>
    <li><a class="dropdown-item" href="../articles/13-cisingle.html">Confidence Intervals for Mean Values in Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/13-enhancedcrosstable.html">Enhanced Cross Tables with danchaltiel/crosstable - Professional Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/13-function-summarydata.html">Vignette: Descriptive Analysis of Continuous Variables in Clinical Data</a></li>
    <li><a class="dropdown-item" href="../articles/14-enhancedtables.html">Enhanced Tables with gt Package - Professional Clinical Research</a></li>
    <li><a class="dropdown-item" href="../articles/14-function-tableone.html">Vignette: Generating a 'Table 1' with ClinicoPathDescriptives</a></li>
    <li><a class="dropdown-item" href="../articles/15-clinical-hemodynamic-monitoring.html">Clinical Hemodynamic Monitoring and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/15-eurostatmap.html">Creating European Statistical Maps with eurostatmap</a></li>
    <li><a class="dropdown-item" href="../articles/15-function-venn.html">Vignette: Visualizing Co-occurrence with Venn &amp; Upset Plots</a></li>
    <li><a class="dropdown-item" href="../articles/15-groupsummary-comprehensive.html">Group and Summarize: Data Aggregation and Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/16-coefficient-plots.html">Coefficient Plots for Regression Models</a></li>
    <li><a class="dropdown-item" href="../articles/16-use-clinicopath-in-r.html">Use ClinicoPathDescriptives in R</a></li>
    <li><a class="dropdown-item" href="../articles/17-desctools.html">Advanced Statistical Tests with DescTools</a></li>
    <li><a class="dropdown-item" href="../articles/18-consort-flowcharts.html">CONSORT Flow Charts for Clinical Trial Reporting</a></li>
    <li><a class="dropdown-item" href="../articles/19-contingency-tables.html">Vignette: Contingency Tables and Association Tests with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/19-flowchart-comprehensive.html">Creating Study Flowcharts with the flowchart Function</a></li>
    <li><a class="dropdown-item" href="../articles/20-ggflowchart-comprehensive.html">Modern Flowcharts with ggFlowchart</a></li>
    <li><a class="dropdown-item" href="../articles/20-paired-contingency-tables.html">Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/21-correlation-analysis.html">Vignette: Comprehensive Correlation Analysis with ClinicoPath</a></li>
    <li><a class="dropdown-item" href="../articles/21-ggprism-comprehensive.html">GraphPad Prism Style Plots with ggprism</a></li>
    <li><a class="dropdown-item" href="../articles/22-gtsummary-comprehensive.html">Publication-Ready Tables with gtsummary</a></li>
    <li><a class="dropdown-item" href="../articles/23-hullplot-comprehensive.html">Hull Plot Visualization for Group Analysis</a></li>
    <li><a class="dropdown-item" href="../articles/37-missingdata-comprehensive.html">Missing Data Analysis and Multiple Imputation</a></li>
    <li><a class="dropdown-item" href="../articles/swimmer-unified-datasets.html">Swimmer Plot Function: Example Datasets Guide</a></li>
    <li><a class="dropdown-item" href="../articles/swimmerplot-unified-comprehensive.html">Swimmer Plot: Comprehensive Clinical Timeline Visualization</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vignette: Paired Samples Contingency Tables and McNemar's Test with ClinicoPath</h1>
                        <h4 data-toc-skip class="author">Analysis by
Claude</h4>
            
            <h4 data-toc-skip class="date">2025-07-31</h4>
      

      <div class="d-none name"><code>20-paired-contingency-tables.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>contTablesPaired</code> function in ClinicoPath provides
specialized analysis for paired samples contingency tables using
McNemar’s test. This function is designed for situations where the same
subjects or matched pairs are measured on two occasions or by two
different methods, making it ideal for inter-rater agreement studies,
before-after comparisons, and diagnostic test evaluations.</p>
<div class="section level3">
<h3 id="when-to-use-paired-contingency-tables">When to Use Paired Contingency Tables<a class="anchor" aria-label="anchor" href="#when-to-use-paired-contingency-tables"></a>
</h3>
<p>Paired contingency tables are used when: - The same subjects are
measured twice (before-after studies) - Two raters evaluate the same
cases (inter-rater agreement) - Comparing two diagnostic tests on the
same patients - Analyzing matched pairs or twins - Testing for marginal
homogeneity in square tables</p>
<p><strong>Key Difference from Independent Samples</strong>: Unlike
regular contingency tables, paired samples account for the correlation
between measurements on the same subjects.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ClinicoPathDescriptives</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Load datasets</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">histopathology</span>, package <span class="op">=</span> <span class="st">"ClinicoPath"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span>, package <span class="op">=</span> <span class="st">"ClinicoPath"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine the rater variables in histopathology</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">histopathology</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rater 1"</span>, <span class="st">"Rater 2"</span>, <span class="st">"Rater 3"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="basic-inter-rater-agreement-analysis">Basic Inter-Rater Agreement Analysis<a class="anchor" aria-label="anchor" href="#basic-inter-rater-agreement-analysis"></a>
</h2>
<p>Let’s start with a basic inter-rater agreement analysis comparing two
pathologists:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic McNemar test for inter-rater agreement</span></span>
<span><span class="va">basic_agreement</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the basic agreement results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">basic_agreement</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="understanding-mcnemars-test">Understanding McNemar’s Test<a class="anchor" aria-label="anchor" href="#understanding-mcnemars-test"></a>
</h3>
<p>McNemar’s test specifically examines the
<strong>disagreement</strong> between paired measurements. It focuses on
the off-diagonal cells: - Cases where Rater 1 = 0 and Rater 2 = 1 -
Cases where Rater 1 = 1 and Rater 2 = 0</p>
<p>If there’s no systematic bias between raters, these disagreements
should be equally distributed.</p>
</div>
</div>
<div class="section level2">
<h2 id="multi-level-agreement-analysis">Multi-Level Agreement Analysis<a class="anchor" aria-label="anchor" href="#multi-level-agreement-analysis"></a>
</h2>
<p>For ordinal or multi-category variables, we can still use McNemar’s
test:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multi-level agreement analysis with Gleason scores</span></span>
<span><span class="va">gleason_agreement</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Urologist_B"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the Gleason agreement results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gleason_agreement</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Check the structure of the Gleason score data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span><span class="op">$</span><span class="va">Urologist_A</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">prostate_agreement_data</span><span class="op">$</span><span class="va">Urologist_B</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="gold-standard-comparison">Gold Standard Comparison<a class="anchor" aria-label="anchor" href="#gold-standard-comparison"></a>
</h2>
<p>A common application is comparing a new rater or method against a
gold standard:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare Urologist A against the true Gleason score</span></span>
<span><span class="va">gold_standard_comparison</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"True_Gleason"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the gold standard comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gold_standard_comparison</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This helps assess the accuracy of Urologist A's diagnoses</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="working-with-count-data">Working with Count Data<a class="anchor" aria-label="anchor" href="#working-with-count-data"></a>
</h2>
<p>The function can handle pre-aggregated count data, useful for
published data or summary tables:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example from the documentation: Survey data</span></span>
<span><span class="va">survey_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  `1st survey` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Approve'</span>, <span class="st">'Approve'</span>, <span class="st">'Disapprove'</span>, <span class="st">'Disapprove'</span><span class="op">)</span>,</span>
<span>  `2nd survey` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'Approve'</span>, <span class="st">'Disapprove'</span>, <span class="st">'Approve'</span>, <span class="st">'Disapprove'</span><span class="op">)</span>,</span>
<span>  `Counts` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">794</span>, <span class="fl">150</span>, <span class="fl">86</span>, <span class="fl">570</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Analysis using count data</span></span>
<span><span class="va">survey_analysis</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"1st survey"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"2nd survey"</span>,</span>
<span>  counts <span class="op">=</span> <span class="st">"Counts"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the survey data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">survey_data</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="formula-interface">Formula Interface<a class="anchor" aria-label="anchor" href="#formula-interface"></a>
</h2>
<p>The function supports formula notation for convenience:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using formula interface with the same survey data</span></span>
<span><span class="va">formula_analysis</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">Counts</span> <span class="op">~</span> <span class="va">`1st survey`</span><span class="op">:</span><span class="va">`2nd survey`</span>,</span>
<span>  data <span class="op">=</span> <span class="va">survey_data</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Alternative without counts (each row = one observation)</span></span>
<span><span class="co"># contTablesPaired(formula = ~ `1st survey`:`2nd survey`, data = expanded_data)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="before-after-analysis">Before-After Analysis<a class="anchor" aria-label="anchor" href="#before-after-analysis"></a>
</h2>
<p>A classic use case is analyzing treatment effects or changes over
time:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create simulated before-after treatment data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">treatment_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>,</span>
<span>  before_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poor"</span>, <span class="st">"Good"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  after_treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Poor"</span>, <span class="st">"Good"</span><span class="op">)</span>, <span class="fl">100</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># McNemar test for treatment effect</span></span>
<span><span class="va">treatment_effect</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">treatment_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"before_treatment"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"after_treatment"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Show the simulated data structure</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">treatment_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">treatment_data</span><span class="op">$</span><span class="va">before_treatment</span>, <span class="va">treatment_data</span><span class="op">$</span><span class="va">after_treatment</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="exact-tests-for-small-samples">Exact Tests for Small Samples<a class="anchor" aria-label="anchor" href="#exact-tests-for-small-samples"></a>
</h2>
<p>For small samples or when assumptions are violated, exact tests can
be useful:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Exact log odds ratio (requires exact2x2 package)</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">exact2x2</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">exact_analysis</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>    rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>    cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>    chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    exact <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Exact test analysis completed"</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"exact2x2 package not available - using standard tests only"</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="co"># Standard analysis without exact test</span></span>
<span>  <span class="va">exact_analysis</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>    rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>    cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>    chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    exact <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="multiple-rater-comparisons">Multiple Rater Comparisons<a class="anchor" aria-label="anchor" href="#multiple-rater-comparisons"></a>
</h2>
<p>Often we need to compare multiple raters against each other:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: Compare Urologist A vs C directly</span></span>
<span><span class="va">urol_a_vs_c</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">prostate_agreement_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Urologist_A"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Urologist_C"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Display the comparison</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">urol_a_vs_c</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="clinical-examples">Clinical Examples<a class="anchor" aria-label="anchor" href="#clinical-examples"></a>
</h2>
<div class="section level3">
<h3 id="example-1-diagnostic-test-agreement">Example 1: Diagnostic Test Agreement<a class="anchor" aria-label="anchor" href="#example-1-diagnostic-test-agreement"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate diagnostic test data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span>
<span><span class="va">diagnostic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  patient_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">150</span>,</span>
<span>  test_method_1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.7</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_method_2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Positive"</span>, <span class="st">"Negative"</span><span class="op">)</span>, <span class="fl">150</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.75</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># McNemar test for diagnostic agreement</span></span>
<span><span class="va">diagnostic_agreement</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">diagnostic_data</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"test_method_1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"test_method_2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Cross-tabulation of diagnostic results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">diagnostic_data</span><span class="op">$</span><span class="va">test_method_1</span>, <span class="va">diagnostic_data</span><span class="op">$</span><span class="va">test_method_2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="example-2-observer-variability-in-pathology">Example 2: Observer Variability in Pathology<a class="anchor" aria-label="anchor" href="#example-2-observer-variability-in-pathology"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Using the actual rater data for pathology scoring</span></span>
<span><span class="va">pathology_agreement</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">histopathology</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 3"</span>,  <span class="co"># Different pair for variety</span></span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcRow <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pcCol <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># This assesses inter-observer variability in pathological assessment</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="interpreting-results">Interpreting Results<a class="anchor" aria-label="anchor" href="#interpreting-results"></a>
</h2>
<div class="section level3">
<h3 id="mcnemars-test-statistics">McNemar’s Test Statistics<a class="anchor" aria-label="anchor" href="#mcnemars-test-statistics"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>χ² (chi-square)</strong>: Tests the null hypothesis that
disagreements are equally distributed
<ul>
<li>Low p-value suggests systematic bias between raters/methods</li>
<li>High p-value suggests no systematic bias (good agreement)</li>
</ul>
</li>
<li>
<strong>χ² with continuity correction</strong>: Yates’ correction
for small samples
<ul>
<li>More conservative than standard χ²</li>
<li>Recommended for 2×2 tables with small expected frequencies</li>
</ul>
</li>
<li>
<strong>Exact log odds ratio</strong>: Provides exact confidence
intervals
<ul>
<li>Useful for small samples or when normal approximation is
questionable</li>
<li>Requires exact2x2 package</li>
</ul>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="agreement-vs--association">Agreement vs. Association<a class="anchor" aria-label="anchor" href="#agreement-vs--association"></a>
</h3>
<ul>
<li>
<strong>McNemar’s test</strong>: Tests for <em>systematic bias</em>
or <em>marginal homogeneity</em>
</li>
<li>
<strong>Not the same as</strong>: Overall agreement or
correlation</li>
<li>
<strong>Use additionally</strong>: Kappa statistics or ICC for
agreement strength</li>
</ul>
</div>
<div class="section level3">
<h3 id="clinical-interpretation-guidelines">Clinical Interpretation Guidelines<a class="anchor" aria-label="anchor" href="#clinical-interpretation-guidelines"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Significant McNemar test (p &lt; 0.05)</strong>:
<ul>
<li>Systematic bias exists between raters/methods</li>
<li>One consistently rates higher/lower than the other</li>
<li>Need to investigate source of bias</li>
</ul>
</li>
<li>
<strong>Non-significant McNemar test (p ≥ 0.05)</strong>:
<ul>
<li>No systematic bias detected</li>
<li>Disagreements are balanced</li>
<li>Still need to assess overall agreement level</li>
</ul>
</li>
<li>
<strong>Contingency Table Patterns</strong>:
<ul>
<li>
<strong>High diagonal values</strong>: Good overall agreement</li>
<li>
<strong>High off-diagonal values</strong>: Poor agreement</li>
<li>
<strong>Asymmetric off-diagonals</strong>: Systematic bias</li>
</ul>
</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="sample-size-considerations">Sample Size Considerations<a class="anchor" aria-label="anchor" href="#sample-size-considerations"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example of how sample size affects power</span></span>
<span><span class="va">small_sample</span> <span class="op">&lt;-</span> <span class="va">histopathology</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span>, <span class="op">]</span></span>
<span></span>
<span><span class="va">small_sample_test</span> <span class="op">&lt;-</span> <span class="fu">contTablesPaired</span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">small_sample</span>,</span>
<span>  rows <span class="op">=</span> <span class="st">"Rater 1"</span>,</span>
<span>  cols <span class="op">=</span> <span class="st">"Rater 2"</span>,</span>
<span>  chiSq <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  chiSqCorr <span class="op">=</span> <span class="cn">TRUE</span>  <span class="co"># Continuity correction especially important for small samples</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># With small samples, consider exact tests</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="best-practices-for-clinical-research">Best Practices for Clinical Research<a class="anchor" aria-label="anchor" href="#best-practices-for-clinical-research"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Pre-specify hypotheses</strong>: Define what constitutes
acceptable agreement</li>
<li>
<strong>Power calculations</strong>: Ensure adequate sample size for
detecting meaningful differences</li>
<li>
<strong>Multiple comparisons</strong>: Adjust for multiple testing
when comparing many rater pairs</li>
<li>
<strong>Context matters</strong>: Consider clinical significance,
not just statistical significance</li>
<li>
<strong>Report effect sizes</strong>: Include measures of agreement
strength (kappa, ICC)</li>
<li>
<strong>Validate findings</strong>: Use independent datasets when
possible</li>
</ol>
</div>
<div class="section level2">
<h2 id="troubleshooting-common-issues">Troubleshooting Common Issues<a class="anchor" aria-label="anchor" href="#troubleshooting-common-issues"></a>
</h2>
<div class="section level3">
<h3 id="non-22-tables">Non-2×2 Tables<a class="anchor" aria-label="anchor" href="#non-22-tables"></a>
</h3>
<p>For tables larger than 2×2, McNemar’s test becomes a test of marginal
homogeneity but may have reduced power.</p>
</div>
<div class="section level3">
<h3 id="small-expected-frequencies">Small Expected Frequencies<a class="anchor" aria-label="anchor" href="#small-expected-frequencies"></a>
</h3>
<p>Use continuity correction or exact tests when expected frequencies
are small.</p>
</div>
<div class="section level3">
<h3 id="missing-data">Missing Data<a class="anchor" aria-label="anchor" href="#missing-data"></a>
</h3>
<p>The function uses complete cases only. Consider multiple imputation
for missing data patterns.</p>
</div>
<div class="section level3">
<h3 id="multiple-categories">Multiple Categories<a class="anchor" aria-label="anchor" href="#multiple-categories"></a>
</h3>
<p>For ordinal data, consider alternative approaches like weighted kappa
or ordinal McNemar tests.</p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The <code>contTablesPaired</code> function provides a comprehensive
toolkit for analyzing paired samples contingency tables in clinical
research. From basic inter-rater agreement to complex diagnostic test
comparisons, it handles the unique challenges of paired data while
providing appropriate statistical tests.</p>
<p>Key advantages: - Accounts for within-subject correlation - Multiple
test options (standard, continuity correction, exact) - Flexible data
input (individual observations or counts) - Formula interface for
convenience - Comprehensive error handling</p>
<p>This makes it an essential tool for quality assurance, method
comparison, and reliability studies in clinical pathology and medical
research.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Serdar Balci.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
